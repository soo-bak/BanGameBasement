<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
    display: grid;
    grid-template-columns: 250px 1fr 250px;
    gap: 20px;
}

.sidebar {
    background: white;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.rankings {
    width: 100%;
}

.ranking-item {
    display: grid;
    grid-template-columns: 30px 1fr;
    padding: 10px;
    margin: 5px 0;
    border-radius: 4px;
    align-items: center;
    border-left: 3px solid transparent;
}

.ranking-item:nth-child(1) {
    background-color: #fafafa;
    border-left-color: #ffd700;  /* ê¸ˆìƒ‰ */
}

.ranking-item:nth-child(2) {
    background-color: #fafafa;
    border-left-color: #c0c0c0;  /* ì€ìƒ‰ */
}

.ranking-item:nth-child(3) {
    background-color: #fafafa;
    border-left-color: #cd7f32;  /* ë™ìƒ‰ */
}

.ranking-item:last-child {
    border-bottom: none;
    background-color: #fff0f0;  /* ìµœí•˜ìœ„íŒ€ ë°°ê²½ìƒ‰ */
}

.rank {
    font-weight: bold;
    font-size: 1.1em;
    color: #444;
}

.team-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.team-name {
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
}

.team-stats {
    font-size: 0.9em;
    color: #666;
}

.rankings-divider {
    height: 1px;
    background: linear-gradient(to right, #eee, #ddd, #eee);
    margin: 15px 0;
}
.sidebar h3 {
    margin-top: 0;
    border-bottom: 2px solid #eee;
    padding-bottom: 10px;
}

.schedule-item {
    padding: 8px;
    margin: 5px 0;
    border-radius: 4px;
}

.schedule-item.completed {
    background: #f5f5f5;
    color: #666;
}

.current-match {
    background: #e3f2fd;
    font-weight: bold;
}
        .teams-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .team {
            border: 2px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .team-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            align-items: center;
        }

        .team-header h3 {
            margin: 0;
            font-size: 1.4em;
        }

        .roster {
            border: 1px solid #eee;
            padding: 10px;
            background-color: #fafafa;
        }

        .player {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px;
            border-bottom: 1px solid #eee;
        }

        .fa-market {
            border: 2px solid #f0ad4e;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            background-color: white;
        }

        .game-screen {
            border: 2px solid #5bc0de;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            background-color: white;
            border-radius: 8px;
        }

        .score {
            font-size: 28px;
            margin: 10px 0;
            font-weight: bold;
            color: #333;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #f5f5f5;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress {
            width: 0%;
            height: 100%;
            background-color: #5bc0de;
            border-radius: 4px;
            transition: width 0.3s;
        }

        .commentary {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            background-color: #fafafa;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .news {
            border: 1px solid #ddd;
            padding: 10px;
            margin-top: 10px;
            height: 100px;
            overflow-y: auto;
            background-color: white;
        }

        button {
            padding: 6px 12px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            background-color: #5bc0de;
            color: white;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #46b8da;
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        #progressButton {
            font-size: 1.2em;
            padding: 10px 20px;
            display: block;
            margin: 20px auto;
        }

        .kill-score {
            font-size: 0.9em;
            color: #666;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
    <div class="sidebar left">
        <h3>ìˆœìœ„í‘œ</h3>
        <div id="rankings"></div>
    </div>
    <div class="main-content">
    <div class="teams-container" id="teamsContainer"></div>
    <div class="news" id="news"></div>
    <div class="fa-market" id="faMarket">
        <h3>FA ì‹œì¥</h3>
        <div id="faPlayers"></div>
    </div>
    <button onclick="progressGame()" id="progressButton">ì§„í–‰</button>
    <div class="game-screen" id="gameScreen">
        <div class="score" id="score"></div>
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        <div class="kill-score" id="killScore"></div>
        <div class="commentary" id="commentary"></div>
    </div>
    
</div>
<div class="sidebar right">
        <h3>ì‹œì¦Œ ì •ë³´</h3>
        <div id="seasonInfo"></div>
        <h3>ê²½ê¸° ì¼ì •</h3>
        <div id="schedule"></div>
    </div>
<script>
const proPlayers = [
"í˜ì´ì»¤", "ìš°ì§€", "ê³ ë¦´ë¼", "ë°í”„íŠ¸", "ë§¤ë“œë¼ì´í”„",
"ë² ë…¼", "ì¹¸", "ë£¨í‚¤", "ì‡¼ë©”ì´ì»¤", "ìŠ¤ì½”ì–´",
"í˜ì´íŠ¸", "í´ë¦¬ë“œ", "í”¼ë„›", "ë¹„ë””ë””", "ì»¤ì¦ˆ",
"ë„ˆêµ¬ë¦¬", "ì¼€ë¦¬ì•„", "ë£°ëŸ¬", "êµ¬ë§ˆìœ ì‹œ", "ì œìš°ìŠ¤",
"ìµ¸ë¹„", "ë„ë€", "ê¸°ì¸", "ì•°ë¹„ì…˜", "í”„ë ˆì´",
"ë£¨ì‹œë“œ", "ìš¸í”„", "ìŠ¤ë§µ", "ë±…", "ì°¨í•„ê·¼",
"í‚¤ì•„ë€", "ì˜¤ì„±êµ­", "ì´ìœ ì›", "ìºë‹ˆì–¸", "ì •ìœ¤ì§€",
"ì˜¤ë„ˆ", "ë¼ìŠ¤ì¹¼", "ë¦¬í—¨ì¦ˆ", "í¬ë¼ìš´", "ì£¼í•œ",
"ë§ˆíƒ€", "í…Œë””", "ì¿ ì”", "ì ¯íŠ¸", "ë ˆì˜¨",
"ì¥ì¬ì˜", "ë¯¸í‚¤", "ë² ë¦´", "ë°”ì´í¼", "í‘œì‹",
"í‘¸ë§Œë‘", "ë±…ê¸°", "ë•ë‹´", "ë¥˜", "ì¡°ì»¤",
"ë¹ ë¥¸ë³„", "ë„íŒŒ", "ë„ë¡œ", "ê´´ë¬¼ì¥", "ê°±ë§˜",
"íŒŒì¹´", "ë™ìˆ˜ì¹¸", "í•´ë¬¼íŒŒì „", "ë‹¤ë°", "ìº¡í‹´ì­",
"ì„í”„", "í—¬ë¦¬ì˜¤ìŠ¤", "ë‚˜ê·¸ë„¤", "ì›…", "ëª¨ê¸€ë¦¬",
"ë©”ì´ì½”", "ë¯¼ì•„ë¦¬", "ì¨ë°‹", "ë„ì¸ë¹„", "ì¹´ë‚˜ë¹„",
"ì œì¹´", "ë°ìš©", "ì¹¸ë‚˜", "ë¯¸í‚¤ì–‘", "í•´ì»¤",
"ë¦¬ì•ˆë“œë¦¬", "ìƒ¤ì˜¤í›„", "ë‚˜ì´íŠ¸", "í—ˆìˆ˜", "ì¿ ë¡œ",
"ìŠ¤ì¹´ìš°íŠ¸", "íˆ¬ì‚°", "í‚¤ë¦¬ì•„", "ê¸°ë„", "í”¼ë„›",
"ì„¸ë‚˜", "ìŠ¤ì¹´ì´", "ë‹´ì›ë´‡", "ì–´ìœˆ", "ë ˆì´ë¸",
"ë¸”ë¼ì¸ë“œ", "ì†Œí”„íŠ¸", "ë¬´ì‹œ", "í‚¤ë“œ", "ë¡œì¼“",
"ì—˜ë¦¼", "ì•…ì–´", "íˆì˜¤ì“°", "ì†Œí™˜", "í´ë¼",
"ì¼€ì¸", "ìœ™ë“œ", "í™”ë‚¨", "íŠ¸ìœ„ìŠ¤íŠ¸", "í‚¹",
"ë…¸í˜", "ë¹„ì¥¬", "í•«ë¸”ë¼ë“œ", "ë¹„ì£¼", "í”Œë ˆì„",
"ì–´ë¼ìš´ë“œ", "ëª¨ê±´", "ë°°ëŸ°", "ê¸€ë ˆì´ë¸Œ", "íŠ¸ë¡¤",
"ì¤‘ì¥ë¹„", "ìƒ¤ì›Œ", "ìŠ¤í‹°ì¹˜", "ì´ê·¸ë‚˜", "ì— í™íŠ¸",
"í”„ë¡œì„¼", "ì— í˜ëŸ¬", "ì†Œë…„", "ì—˜ë¦¬ì‹œ", "í˜¸ì•¼"
];

const battleDescriptions = [
    " ë§ˆì£¼ì³¤ìŠµë‹ˆë‹¤.",
    " ëŒ€ì¹˜ì¤‘ì…ë‹ˆë‹¤.",
    " ì‹ ê²½ì „ì„ ë²Œì…ë‹ˆë‹¤.",
    " ì¡°ìš°í–ˆìŠµë‹ˆë‹¤."
];

const victoryDescriptions = [
    " ì²˜ì¹˜!",
    " ì••ì‚´!",
    " ìƒëŒ€ë¡œ í‚¬ì„ ë”°ëƒ…ë‹ˆë‹¤!",
    " ì œì••!",
    " ë°•ì‚´ë‚´ë²„ë ¸ìŠµë‹ˆë‹¤!",
    " ê·¹ì ìœ¼ë¡œ ì²˜ì¹˜!",
    " ì¡ì•„ëƒˆìŠµë‹ˆë‹¤!",
    " ì•„ìŠ¬ì•„ìŠ¬í•˜ê²Œ ì²˜ì¹˜!",
    " ê°€ë³ê²Œ ì²˜ì¹˜!",
    " ìƒëŒ€ë¡œ ìŠ¹ë¦¬!"
];

class Player {
    constructor(name, teamEmoji = "", teamName = "") {
        this.name = name;
        this.teamEmoji = teamEmoji;
        this.teamName = teamName;
        this.skill = Math.floor(Math.random() * 100) + 1;
        this.kills = 0;
        this.deaths = 0;
        this.matchKills = 0;
        this.matchDeaths = 0;
        this.previousTeam = "";
        this.age = Math.floor(Math.random() * 6) + 17;
    }

    getKDRatio() {
        if (this.deaths === 0) {
            if (this.kills === 0) return 1; // 0/0ì¸ ê²½ìš° 1ë¡œ ì²˜ë¦¬
            return this.kills;              // n/0ì¸ ê²½ìš° nìœ¼ë¡œ ì²˜ë¦¬
        }
        return this.kills / this.deaths;
    }
}

    class Team {
        constructor(name, emoji, isMyTeam = false) {
            this.name = name;
            this.emoji = emoji;
            this.isMyTeam = isMyTeam;
            this.money = 10; // 10ì–µìœ¼ë¡œ ìˆ˜ì •
            this.wins = 0;
            this.losses = 0;   
            this.trophies = 0; 
            this.roster = [];
            this.fillRoster();
        }

        fillRoster() {
            while (this.roster.length < 5) {
                const randomIndex = Math.floor(Math.random() * proPlayers.length);
                const playerName = proPlayers.splice(randomIndex, 1)[0];
                const player = new Player(playerName, this.emoji, this.name);
                this.roster.push(player);
            }
        }

        findWorstKDPlayer() {
            return this.roster.reduce((worst, current) => 
                current.getKDRatio() < worst.getKDRatio() ? current : worst
            );
        }
    }

    let teams = [
        new Team("Banjiha", "ğŸ¦", true),
        new Team("T1", "ğŸ¯"),
        new Team("GenG", "ğŸ"),
        new Team("Hanwha", "ğŸ¦…"),
        new Team("DRX", "ğŸ²"),
        new Team("KT", "âš”ï¸")
    ];
    let progressCount = 0;
    let currentYear = 2024;
let matchSchedule = [];
    let faPlayers = [];
    let currentMatchIndex = 0;
    let isGameInProgress = false;
    let nextMatchTeams = null;
    const teamNames = ["DRX", "KT", "JDG", "Afreeca", "CJ", "Nongshim", "Jin Air", "DAMWON", "Najin", "T1", "GenG", "Hanwha",
    "ROX", "Samsung", "MVP", "BBQ", "Griffin", "KOO", "Longzhu", "SANDBOX"];
    const teamEmojis = ["ğŸ¦Š", "ğŸ²", "ğŸ¯", "ğŸ®", "âš”ï¸", "ğŸ›¡ï¸", "ğŸ—¡ï¸", "ğŸ¦", "ğŸº", "ğŸ¦…", "ğŸ", "ğŸ§©",
    "ğŸ²", "â­", "ğŸ¯", "ğŸ—", "ğŸ¦ˆ", "ğŸ˜", "ğŸ‰", "ğŸ“¦"];
    function initializeFAMarket() {
        for (let i = 0; i < 5; i++) {
            if (proPlayers.length > 0) {
                const randomIndex = Math.floor(Math.random() * proPlayers.length);
                const playerName = proPlayers.splice(randomIndex, 1)[0];
                const player = new Player(playerName);
                player.price = Math.floor(Math.random() * 10) + 1;
                faPlayers.push(player);
            }
        }
    }
    function generateSeasonSchedule() {
    matchSchedule = [];
    for (let round = 0; round < 2; round++) {  // 2ë¼ìš´ë“œ
        for (let i = 0; i < teams.length; i++) {
            for (let j = i + 1; j < teams.length; j++) {
                matchSchedule.push({
                    team1: round % 2 === 0 ? teams[i] : teams[j],
                    team2: round % 2 === 0 ? teams[j] : teams[i],
                    completed: false,
                    winner: null,
                    score1: 0,
                    score2: 0
                });
            }
        }
    }
}
    function renderTeams() {
    const container = document.getElementById('teamsContainer');
    container.innerHTML = '';

    teams.forEach(team => {
        const teamDiv = document.createElement('div');
        teamDiv.className = 'team';
        teamDiv.innerHTML = `
            <div class="team-header">
                <h3>${team.emoji} ${team.name} ${team.trophies > 0 ? 'ğŸ†'.repeat(team.trophies) : ''}</h3>
                <div>ë³´ìœ ê¸ˆ: ${team.money}ì–µ | ${team.wins}ìŠ¹ ${team.losses}íŒ¨</div>
            </div>
            <div class="roster">
                ${team.roster.map(player => `
                    <div class="player">
                        <span>${player.name} [${player.age}ì„¸] (K:${player.kills} D:${player.deaths})</span>
                        ${team.isMyTeam ? `<button onclick="releasePlayer('${player.name}')">ë°©ì¶œ</button>` : ''}
                    </div>
                `).join('')}
            </div>
        `;
        container.appendChild(teamDiv);
    });
}

    function renderFAMarket() {
        const market = document.getElementById('faPlayers');
        market.innerHTML = faPlayers.map(player => `
   <div class="player">
       <span>${player.name} [${player.age}ì„¸] (ê°€ê²©: ${player.price}ì–µ)
       [K:${player.kills} D:${player.deaths}] 
       ${player.previousTeam ? `| ${player.teamEmoji} ${player.previousTeam} ì¶œì‹ ` : ''}</span>
       <button onclick="signPlayer('${player.name}')">ì˜ì…</button>
   </div>
`).join('');

        if (faPlayers.length < 3 && Math.random() < 0.5) {
            const unusedNames = proPlayers.filter(name => 
                !teams.some(team => team.roster.some(p => p.name === name)) &&
                !faPlayers.some(p => p.name === name)
            );
            if (unusedNames.length > 0) {
                const randomName = unusedNames[Math.floor(Math.random() * unusedNames.length)];
                const index = proPlayers.indexOf(randomName);
                if (index > -1) proPlayers.splice(index, 1);
                const newPlayer = new Player(randomName);
                newPlayer.price = Math.floor(Math.random() * 10) + 1;
                faPlayers.push(newPlayer);
                renderFAMarket();
            }
        }
    }

    function addNews(message) {
        const news = document.getElementById('news');
        news.innerHTML = `<p>${message}</p>` + news.innerHTML;
        while (news.childNodes.length > 5) {
            news.removeChild(news.lastChild);
        }
    }

    function releasePlayer(playerName) {
    const myTeam = teams[0];
    const playerIndex = myTeam.roster.findIndex(p => p.name === playerName);
    if (playerIndex !== -1 && myTeam.roster.length > 1) {
        const player = myTeam.roster.splice(playerIndex, 1)[0];
        player.previousTeam = player.teamName;
        player.price = Math.floor(Math.random() * 10) + 1;
        // killsì™€ deathsëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ë¨
        faPlayers.push(player);
        addNews(`${myTeam.name}ì´(ê°€) ${playerName}ì„(ë¥¼) ë°©ì¶œí–ˆìŠµë‹ˆë‹¤.`);
        renderTeams();
        renderFAMarket();
    }
}

    function signPlayer(playerName) {
        const myTeam = teams[0];
        const player = faPlayers.find(p => p.name === playerName);
        
        if (player && myTeam.roster.length < 5 && myTeam.money >= player.price) {
            myTeam.money -= player.price;
            player.teamEmoji = myTeam.emoji;
            player.teamName = myTeam.name;
            myTeam.roster.push(player);
            faPlayers = faPlayers.filter(p => p !== player);
            addNews(`${myTeam.name}, ${playerName} ${player.price}ì–µì— ì˜ì…í–ˆìŠµë‹ˆë‹¤.`);
            renderTeams();
            renderFAMarket();
        }
    }
    function processAITeamTransfers() {
    teams.slice(1).forEach(team => {
        try {
            if (Math.random() < 0.15) {
                const lowPerformers = team.roster.filter(p => p.getKDRatio() < 1);
                
                if (lowPerformers.length > 0) {
                    const worstPlayer = lowPerformers.reduce((worst, current) => 
                        current.getKDRatio() < worst.getKDRatio() ? current : worst
                    );

                    const affordablePlayers = faPlayers.filter(p => 
                        p.price <= team.money && p.getKDRatio() >= worstPlayer.getKDRatio()
                    );

                    if (affordablePlayers.length > 0) {
                        const targetPlayer = affordablePlayers[Math.floor(Math.random() * affordablePlayers.length)];
                        
                        // ëˆ ì²˜ë¦¬
                        team.money -= targetPlayer.price;

                        // ë°©ì¶œë˜ëŠ” ì„ ìˆ˜ ì²˜ë¦¬
                        worstPlayer.previousTeam = worstPlayer.teamName;  // ì´ì „ ì†Œì†íŒ€ ê¸°ë¡
                        worstPlayer.teamName = "";  // í˜„ì¬ ì†Œì†íŒ€ ì´ˆê¸°í™”
                        worstPlayer.teamEmoji = ""; // í˜„ì¬ íŒ€ ì´ëª¨ì§€ ì´ˆê¸°í™”
                        worstPlayer.price = Math.floor(Math.random() * 10) + 1;
                        
                        // ì˜ì…ë˜ëŠ” ì„ ìˆ˜ ì²˜ë¦¬
                        targetPlayer.previousTeam = targetPlayer.teamName; // ì´ì „ ì†Œì†íŒ€ ê¸°ë¡
                        targetPlayer.teamName = team.name;   // ìƒˆë¡œìš´ ì†Œì†íŒ€ ì„¤ì •
                        targetPlayer.teamEmoji = team.emoji; // ìƒˆë¡œìš´ íŒ€ ì´ëª¨ì§€ ì„¤ì •
                        
                        // ë¡œìŠ¤í„° ì—…ë°ì´íŠ¸
                        team.roster = team.roster.filter(p => p !== worstPlayer);
                        team.roster.push(targetPlayer);
                        
                        // FA ë§ˆì¼“ ì—…ë°ì´íŠ¸
                        faPlayers = faPlayers.filter(p => p !== targetPlayer);
                        faPlayers.push(worstPlayer);
                        
                        addNews(`${team.emoji} ${team.name}, ${worstPlayer.name} ë°©ì¶œí•˜ê³  ${targetPlayer.name} ì˜ì…`);
                    }
                }
            }
        } catch (error) {
            console.error("AI Team Transfer Error:", error);
        }
    });
}
function updateRankings() {
    const rankedTeams = [...teams].sort((a, b) => {
        const diffA = a.wins - a.losses;
        const diffB = b.wins - b.losses;
        if (diffA === diffB) {
            return b.wins - a.wins;
        }
        return diffB - diffA;
    });

    const rankings = document.getElementById('rankings');
    rankings.innerHTML = `
        <div class="rankings">
            ${rankedTeams.map((team, index) => `
                <div class="ranking-item">
                    <div class="rank">${index + 1}</div>
                    <div class="team-info">
                        <div class="team-name">
                            ${team.emoji} ${team.name} ${team.trophies > 0 ? 'ğŸ†'.repeat(team.trophies) : ''}
                        </div>
                        <div class="team-stats">
                            ${team.wins}ìŠ¹ ${team.losses}íŒ¨ (${team.wins - team.losses > 0 ? '+' : ''}${team.wins - team.losses})
                        </div>
                    </div>
                </div>
                ${index === 2 ? '<div class="rankings-divider"></div>' : ''}  <!-- 3ìœ„ í›„ êµ¬ë¶„ì„  -->
            `).join('')}
        </div>
    `;
}

// ì‹œì¦Œ ì •ë³´ì™€ ì¼ì • ì—…ë°ì´íŠ¸ í•¨ìˆ˜
function updateSeasonInfo() {
    const seasonInfo = document.getElementById('seasonInfo');
    seasonInfo.innerHTML = `
        <div>${currentYear}ì‹œì¦Œ</div>
        <div>ê²½ê¸° ì§„í–‰: ${currentMatchIndex}/${matchSchedule.length}</div>
    `;

    const schedule = document.getElementById('schedule');
    schedule.innerHTML = matchSchedule.map((match, index) => `
        <div class="schedule-item ${match.completed ? 'completed' : ''} ${index === currentMatchIndex ? 'current-match' : ''}">
            ${match.team1.emoji} ${match.team1.name} vs ${match.team2.emoji} ${match.team2.name}
            ${match.completed ? 
                `<div>${match.score1} : ${match.score2}</div>` : 
                ''}
        </div>
    `).join('');
}
    function simulateMatch(team1, team2) {
        isGameInProgress = true;
        const commentary = document.getElementById('commentary');
        const progress = document.getElementById('progress');
        const score = document.getElementById('score');
        const killScore = document.getElementById('killScore');
team1.roster.forEach(p => { p.matchKills = 0; p.matchDeaths = 0; });
team2.roster.forEach(p => { p.matchKills = 0; p.matchDeaths = 0; });
        commentary.innerHTML = '';
        progress.style.width = '0%';
        let progressValue = 0;
        let team1Score = 0;
        let team2Score = 0;
        
        function updateScore() {
    score.innerHTML = `${team1.emoji} ${team1.name} ${team1Score} : ${team2Score} ${team2.name} ${team2.emoji}`;
    killScore.innerHTML = `
        ${team1.roster.map(p => `${p.name}: ${p.matchKills}/${p.matchDeaths}`).join(' | ')}
        <br>
        ${team2.roster.map(p => `${p.name}: ${p.matchKills}/${p.matchDeaths}`).join(' | ')}
    `;
}
        
        updateScore();
        
        const gameInterval = setInterval(() => {
            progressValue += 2;
            progress.style.width = `${progressValue}%`;
            
            if (progressValue >= 100) {
                clearInterval(gameInterval);
                finishGame(team1, team2, team1Score, team2Score);
                return;
            }
            
            if (Math.random() < 0.25) {
                const player1 = team1.roster[Math.floor(Math.random() * team1.roster.length)];
                const player2 = team2.roster[Math.floor(Math.random() * team2.roster.length)];
                
                
                setTimeout(() => {
                    const multiplier1 = 100 * Math.random();
                    const multiplier2 = 100 * Math.random();
                    
                    const power1 = player1.skill * multiplier1;
                    const power2 = player2.skill * multiplier2;
                    
                    if (Math.abs(power1 - power2) < 10) {
                        commentary.innerHTML = `<div>ì¹˜ì—´í•œ êµì „ ëì— ë‘ ì„ ìˆ˜ ëª¨ë‘ ë¬¼ëŸ¬ë‚¬ìŠµë‹ˆë‹¤.</div>` + commentary.innerHTML;
                    } else if (power1 > power2) {
    team1Score++;
    player1.kills++;           // ëˆ„ì  í‚¬
    player1.matchKills++;      // í˜„ì¬ ê²½ê¸° í‚¬
    player2.deaths++;          // ëˆ„ì  ë°ìŠ¤
    player2.matchDeaths++;     // í˜„ì¬ ê²½ê¸° ë°ìŠ¤
    const victoryDesc = victoryDescriptions[Math.floor(Math.random() * victoryDescriptions.length)];
    commentary.innerHTML = `<div>${player1.teamEmoji} ${player1.teamName} ${player1.name}, ${player2.teamEmoji} ${player2.teamName} ${player2.name}${victoryDesc}</div>` + commentary.innerHTML;
} else {
    team2Score++;
    player2.kills++;           // ëˆ„ì  í‚¬
    player2.matchKills++;      // í˜„ì¬ ê²½ê¸° í‚¬
    player1.deaths++;          // ëˆ„ì  ë°ìŠ¤
    player1.matchDeaths++;     // í˜„ì¬ ê²½ê¸° ë°ìŠ¤
    const victoryDesc = victoryDescriptions[Math.floor(Math.random() * victoryDescriptions.length)];
    commentary.innerHTML = `<div>${player2.teamEmoji} ${player2.teamName} ${player2.name}, ${player1.teamEmoji} ${player1.teamName} ${player1.name}${victoryDesc}</div>` + commentary.innerHTML;
}
                    
                    updateScore();
                },100);
            }
 }, 200);
    }

    function finishGame(team1, team2, team1Score, team2Score) {
        let winner, loser;
        if (team1Score > team2Score) {
            winner = team1;
            loser = team2;
        } else if (team2Score > team1Score) {
            winner = team2;
            loser = team1;
        } else {
            if (Math.random() < 0.5) {
                winner = team1;
                loser = team2;
            } else {
                winner = team2;
                loser = team1;
            }
        }
        
        winner.wins++;
        winner.money += 1;
        loser.losses++;
        
        winner.roster.forEach(player => {
            player.skill = Math.min(100, player.skill + Math.floor(Math.random() * 4));
        });
        
        loser.roster.forEach(player => {
            player.skill = Math.max(1, player.skill - Math.floor(Math.random() * 2));
        });
        
        addNews(`${winner.emoji} ${winner.name}, ${loser.emoji} ${loser.name} ìƒëŒ€ë¡œ ìŠ¹ë¦¬í–ˆìŠµë‹ˆë‹¤!`);
        
        isGameInProgress = false;
        nextMatchTeams = null;
        renderTeams();
    }
    function processYearEnd() {
    // íŒ€ë“¤ì„ ìŠ¹ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ìŠ¹ìˆ˜ê°€ ê°™ìœ¼ë©´ íŒ¨ìˆ˜ê°€ ì ì€ íŒ€ì´ ìƒìœ„)
    const rankedTeams = [...teams].sort((a, b) => {
        const diffA = a.wins - a.losses;
        const diffB = b.wins - b.losses;
        if (diffA === diffB) {
            return b.wins - a.wins;
        }
        return diffB - diffA;
    });

    // ìš°ìŠ¹íŒ€ íŠ¸ë¡œí”¼ ì¶”ê°€
    rankedTeams[0].trophies++;

    // ìˆœìœ„ë³„ ìƒê¸ˆ ì§€ê¸‰
    rankedTeams[0].money += 20; // 1ë“± 10ì–µ
    rankedTeams[1].money += 10;  // 2ë“± 5ì–µ
    rankedTeams[2].money += 5;  // 3ë“± 3ì–µ

    addNews(`ğŸ† ${rankedTeams[0].emoji} ${rankedTeams[0].name} ìš°ìŠ¹í–ˆìŠµë‹ˆë‹¤!`);
    addNews(`ğŸ¥ˆ ${rankedTeams[1].emoji} ${rankedTeams[1].name}: ì¤€ìš°ìŠ¹`);
    addNews(`ğŸ¥‰ ${rankedTeams[2].emoji} ${rankedTeams[2].name}: 3ìœ„`);

    // 4ë“± íŒ€ ì²˜ë¦¬
    const lastTeam = rankedTeams[5];
    
    // 4ë“±íŒ€ ì„ ìˆ˜ë“¤ì„ FA ì‹œì¥ìœ¼ë¡œ
    lastTeam.roster.forEach(player => {
        player.previousTeam = player.teamName;
        player.teamName = "";
        player.teamEmoji = "";
        player.price = player.kills;
        faPlayers.push(player);
    });

    // ìƒˆë¡œìš´ íŒ€ ì´ë¦„ê³¼ ì´ëª¨ì§€ ì„ íƒ
    const availableNames = teamNames.filter(name => !teams.some(t => t.name === name));
    const availableEmojis = teamEmojis.filter(emoji => !teams.some(t => t.emoji === emoji));
    
    const newTeamName = availableNames[Math.floor(Math.random() * availableNames.length)];
    const newTeamEmoji = availableEmojis[Math.floor(Math.random() * availableEmojis.length)];

    // ìƒˆ íŒ€ ìƒì„± - íŠ¸ë¡œí”¼ 0ìœ¼ë¡œ ì‹œì‘
    const newTeam = new Team(newTeamName, newTeamEmoji);
    newTeam.roster = [];
    newTeam.trophies = 0;  // ëª…ì‹œì ìœ¼ë¡œ íŠ¸ë¡œí”¼ 0ìœ¼ë¡œ ì„¤ì •
    
    // ìƒˆë¡œìš´ ì„ ìˆ˜ 3ëª… ì˜ì…
    for (let i = 0; i < 5; i++) {
        if (proPlayers.length > 0) {
            const randomIndex = Math.floor(Math.random() * proPlayers.length);
            const playerName = proPlayers.splice(randomIndex, 1)[0];
            const newPlayer = new Player(playerName, newTeam.emoji, newTeam.name);
            newTeam.roster.push(newPlayer);
        }
    }

    // 4ë“± íŒ€ì„ ìƒˆ íŒ€ìœ¼ë¡œ êµì²´ (íŠ¸ë¡œí”¼ ì´ˆê¸°í™” í¬í•¨)
    const lastTeamIndex = teams.findIndex(t => t === lastTeam);
    teams[lastTeamIndex] = newTeam;

    addNews(`${lastTeam.emoji} ${lastTeam.name}${lastTeam.trophies > 0 ? `(ğŸ†${lastTeam.trophies})` : ''}ì´(ê°€) ê°•ë“±ë˜ê³  ${newTeam.emoji} ${newTeam.name}ì´(ê°€) ìŠ¹ê²©í–ˆìŠµë‹ˆë‹¤.`);

    // ëª¨ë“  íŒ€ì˜ ìŠ¹íŒ¨ ì´ˆê¸°í™”
    teams.forEach(team => {
        team.wins = 0;
        team.losses = 0;
    });
}
function recordMatchResult(team1, team2, team1Score, team2Score) {
    const match = matchSchedule[currentMatchIndex];
    match.completed = true;
    match.score1 = team1Score;
    match.score2 = team2Score;
    if (team1Score > team2Score) {
        match.winner = team1;
    } else {
        match.winner = team2;
    }
}
function progressGame() {
   if (isGameInProgress) return;
   
   progressCount++;

   // FA ì„ ìˆ˜ë“¤ ê°€ê²© ê°ì†Œ ì²˜ë¦¬
   faPlayers.forEach(player => {
       if (Math.random() < 0.5) {
           player.price = Math.max(1, player.price - 1);
       }
   });

   // FA ì„ ìˆ˜ë“¤ ì€í‡´ ì²˜ë¦¬
   faPlayers = faPlayers.filter(player => {
       if (Math.random() < 0.02 && player.price == 1) {
           addNews(`${player.name} ì€í‡´í–ˆìŠµë‹ˆë‹¤.`);
           return false;
       }
       return true;
   });

   // AI íŒ€ ì´ì  ì²˜ë¦¬
   processAITeamTransfers();

   // ë‹¤ìŒ ê²½ê¸° ì§„í–‰
   if (currentMatchIndex < matchSchedule.length) {
       const match = matchSchedule[currentMatchIndex];
       simulateMatch(match.team1, match.team2);
       currentMatchIndex++;
   } else {
       // ì‹œì¦Œ ì¢…ë£Œ ì²˜ë¦¬
       currentYear++;
       addNews(`${currentYear}ë…„ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.`);
       
       processYearEnd();

       // ëª¨ë“  ì„ ìˆ˜ë“¤ì˜ ë‚˜ì´ ì¦ê°€ ë° ê¸°ëŸ‰ ê°ì†Œ
       teams.forEach(team => {
           team.roster.forEach(player => {
               player.age++;
               player.skill = Math.max(1, player.skill - (Math.floor(Math.random() * player.age) + 1));
           });
       });
       
       faPlayers.forEach(player => {
           player.age++;
           player.skill = Math.max(1, player.skill - (Math.floor(Math.random() * player.age) + 1));
       });

       // ìƒˆ ì‹œì¦Œ ì¤€ë¹„
       currentMatchIndex = 0;
       generateSeasonSchedule();
   }

   // UI ì—…ë°ì´íŠ¸
   updateRankings();
   updateSeasonInfo();
   renderTeams();
   renderFAMarket();
}

    // ì´ˆê¸° ë Œë”ë§
    initializeFAMarket();
generateSeasonSchedule();
renderTeams();
renderFAMarket();
updateRankings();
updateSeasonInfo();

</script>
</body>
</html>